<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>泛型 | 深入理解 TypeScript</title>
    <meta name="description" content="TypeScript Deep Dive 中文版">
    <link rel="icon" href="/typescript-book-chinese/logo.png">
  <link rel="manifest" href="/typescript-book-chinese/manifest.json">
  <meta name="theme-color" content="#3eaf7c">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/typescript-book-chinese/assets/css/0.styles.0bb25d97.css" as="style"><link rel="preload" href="/typescript-book-chinese/assets/js/app.9fb1acd5.js" as="script"><link rel="preload" href="/typescript-book-chinese/assets/js/3.5dc3b6f0.js" as="script"><link rel="preload" href="/typescript-book-chinese/assets/js/2.2356e89f.js" as="script"><link rel="preload" href="/typescript-book-chinese/assets/js/73.3b873418.js" as="script"><link rel="prefetch" href="/typescript-book-chinese/assets/js/10.f789003c.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/11.0b6d966e.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/12.32b1fbf6.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/13.7be461d5.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/14.aa49f7f1.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/15.b0288de8.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/16.9b9a5353.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/17.1f91ff04.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/18.29a352bf.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/19.8b76499d.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/20.644a6a00.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/21.21e0b747.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/22.afc8b045.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/23.3d7b243f.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/24.370c0f80.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/25.be50635e.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/26.edf19ca4.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/27.9470165d.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/28.0d8b8b40.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/29.86c5d472.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/30.98d5d132.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/31.7285b7c4.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/32.9d63beb4.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/33.da43ae1b.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/34.39f2a70a.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/35.3ccdeb20.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/36.d8d0311b.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/37.62c28e99.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/38.a86c8109.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/39.3b3dc389.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/4.563ea361.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/40.6ac1bc50.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/41.5522d486.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/42.1b0d28c6.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/43.22dee757.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/44.3108daf3.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/45.11e02a19.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/46.8914ae76.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/47.e58d43e3.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/48.b54e374e.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/49.6aad13fa.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/5.b838d5f4.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/50.53ba66cf.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/51.0f23da37.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/52.1d27a2a3.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/53.1aacad92.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/54.ed35cd7a.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/55.ade6ff2e.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/56.a08cedd3.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/57.7fb57b22.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/58.3fcdf19e.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/59.1ac9677d.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/6.adf49566.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/60.aa39682b.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/61.bdad2e93.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/62.26c2a096.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/63.11035d84.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/64.fc4debec.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/65.654f90b2.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/66.d79cfd8b.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/67.c3cd4774.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/68.ec9a8e3e.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/69.15f71cb4.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/7.c2df7ee3.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/70.58754ea6.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/71.c1c86b8a.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/72.4bafb8c9.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/74.55e3e6e5.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/75.f487663b.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/76.08c3242c.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/77.bae9a6e5.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/78.8ca28508.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/79.35fbb060.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/8.b26f4cb0.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/80.4f0b96af.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/81.416436af.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/82.e960a799.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/83.0befbf48.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/84.7eb264db.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/85.beaac9d1.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/86.f19fd5db.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/87.ba1ac4a3.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/88.1d9ba5e2.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/89.89023889.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/9.9de19e55.js"><link rel="prefetch" href="/typescript-book-chinese/assets/js/90.a1158013.js">
    <link rel="stylesheet" href="/typescript-book-chinese/assets/css/0.styles.0bb25d97.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/typescript-book-chinese/" class="home-link router-link-active"><!----> <span class="site-name">深入理解 TypeScript</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://basarat.gitbooks.io/typescript/content/docs/getting-started.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  原书链接
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://jkchao.cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/jkchao/typescript-book-chinese" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://basarat.gitbooks.io/typescript/content/docs/getting-started.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  原书链接
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://jkchao.cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/jkchao/typescript-book-chinese" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <div class="ads" data-v-0bfb48e2><div class="item" data-v-0bfb48e2><h6 class="title" style="display:;" data-v-0bfb48e2>关注公众号</h6> <div class="thumb" data-v-0bfb48e2><a href="/typescript-book-chinese/qrcode.jpg" target="_blank" data-v-0bfb48e2><img src="/typescript-book-chinese/qrcode.jpg" alt="关注公众号" data-v-0bfb48e2></a></div></div><div class="item" data-v-0bfb48e2><h6 class="title" style="display:;" data-v-0bfb48e2>与我交流</h6> <div class="thumb" data-v-0bfb48e2><a href="/typescript-book-chinese/contact.png" target="_blank" data-v-0bfb48e2><img src="/typescript-book-chinese/contact.png" alt="与我交流" data-v-0bfb48e2></a></div></div><div class="item" data-v-0bfb48e2><h6 class="title" style="display:;" data-v-0bfb48e2>购买此书</h6> <div class="thumb" data-v-0bfb48e2><a href="https://item.jd.com/12755624.html" target="_blank" data-v-0bfb48e2><img src="https://static.jkchao.cn/2019-11-22/WechatIMG719.png?imageMogr2/auto-orient/thumbnail/80x/blur/1x0/quality/75|imageslim" alt="购买此书" data-v-0bfb48e2></a></div></div></div> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>写在前面</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/typescript-book-chinese/" class="sidebar-link">深入理解 TypeScript</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>TypeScript 项目</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/typescript-book-chinese/project/compilationContext.html" class="sidebar-link">编译上下文</a></li><li><a href="/typescript-book-chinese/project/declarationspaces.html" class="sidebar-link">声明空间</a></li><li><a href="/typescript-book-chinese/project/modules.html" class="sidebar-link">模块</a></li><li><a href="/typescript-book-chinese/project/namespaces.html" class="sidebar-link">命名空间</a></li><li><a href="/typescript-book-chinese/project/dynamicImportExpressions.html" class="sidebar-link">动态导入表达式</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>TypeScript 类型系统</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/typescript-book-chinese/typings/overview.html" class="sidebar-link">概览</a></li><li><a href="/typescript-book-chinese/typings/migrating.html" class="sidebar-link">从 JavaScript 迁移</a></li><li><a href="/typescript-book-chinese/typings/types.html" class="sidebar-link">@types</a></li><li><a href="/typescript-book-chinese/typings/ambient.html" class="sidebar-link">环境声明</a></li><li><a href="/typescript-book-chinese/typings/interfaces.html" class="sidebar-link">接口</a></li><li><a href="/typescript-book-chinese/typings/enums.html" class="sidebar-link">枚举</a></li><li><a href="/typescript-book-chinese/typings/lib.html" class="sidebar-link">lib.d.ts</a></li><li><a href="/typescript-book-chinese/typings/functions.html" class="sidebar-link">函数</a></li><li><a href="/typescript-book-chinese/typings/callable.html" class="sidebar-link">可调用的</a></li><li><a href="/typescript-book-chinese/typings/typeAssertion.html" class="sidebar-link">类型断言</a></li><li><a href="/typescript-book-chinese/typings/freshness.html" class="sidebar-link">Freshness</a></li><li><a href="/typescript-book-chinese/typings/typeGuard.html" class="sidebar-link">类型保护</a></li><li><a href="/typescript-book-chinese/typings/literals.html" class="sidebar-link">字面量类型</a></li><li><a href="/typescript-book-chinese/typings/readonly.html" class="sidebar-link">readonly</a></li><li><a href="/typescript-book-chinese/typings/generices.html" class="active sidebar-link">泛型</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/typescript-book-chinese/typings/generices.html#动机和示例" class="sidebar-link">动机和示例</a></li><li class="sidebar-sub-header"><a href="/typescript-book-chinese/typings/generices.html#误用的泛型" class="sidebar-link">误用的泛型</a></li><li class="sidebar-sub-header"><a href="/typescript-book-chinese/typings/generices.html#设计模式：方便通用" class="sidebar-link">设计模式：方便通用</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/typescript-book-chinese/typings/generices.html#配合-axios-使用" class="sidebar-link">配合 axios 使用</a></li></ul></li></ul></li><li><a href="/typescript-book-chinese/typings/typeInference.html" class="sidebar-link">类型推断</a></li><li><a href="/typescript-book-chinese/typings/typeCompatibility.html" class="sidebar-link">类型兼容性</a></li><li><a href="/typescript-book-chinese/typings/neverType.html" class="sidebar-link">Never</a></li><li><a href="/typescript-book-chinese/typings/discrominatedUnion.html" class="sidebar-link">辨析联合类型</a></li><li><a href="/typescript-book-chinese/typings/indexSignatures.html" class="sidebar-link">索引签名</a></li><li><a href="/typescript-book-chinese/typings/movingTypes.html" class="sidebar-link">流动的类型</a></li><li><a href="/typescript-book-chinese/typings/exceptionsHanding.html" class="sidebar-link">异常处理</a></li><li><a href="/typescript-book-chinese/typings/mixins.html" class="sidebar-link">混合</a></li><li><a href="/typescript-book-chinese/typings/thisType.html" class="sidebar-link">ThisType</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>JSX</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/typescript-book-chinese/jsx/support.html" class="sidebar-link">支持 JSX</a></li><li><a href="/typescript-book-chinese/jsx/reactJSX.html" class="sidebar-link">React JSX</a></li><li><a href="/typescript-book-chinese/jsx/nonReactJSX.html" class="sidebar-link">非 React JSX</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>TypeScript 错误提示</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/typescript-book-chinese/error/interpreting.html" class="sidebar-link">解读 Errors</a></li><li><a href="/typescript-book-chinese/error/common.html" class="sidebar-link">常见的 Error</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>TIPs</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/typescript-book-chinese/tips/stringBasedEmuns.html" class="sidebar-link">基于字符串的枚举</a></li><li><a href="/typescript-book-chinese/tips/nominalTyping.html" class="sidebar-link">名义化类型</a></li><li><a href="/typescript-book-chinese/tips/statefulFunctions.html" class="sidebar-link">状态函数</a></li><li><a href="/typescript-book-chinese/tips/bind.html" class="sidebar-link">Bind 是有害的</a></li><li><a href="/typescript-book-chinese/tips/curry.html" class="sidebar-link">柯里化</a></li><li><a href="/typescript-book-chinese/tips/typeInstantiation.html" class="sidebar-link">泛型的实例化类型</a></li><li><a href="/typescript-book-chinese/tips/lazyObjectLiteralInitialization.html" class="sidebar-link">对象字面量的惰性初始化</a></li><li><a href="/typescript-book-chinese/tips/classAreUseful.html" class="sidebar-link">类是有用的</a></li><li><a href="/typescript-book-chinese/tips/avoidExportDefault.html" class="sidebar-link">export default 被认为是有害的</a></li><li><a href="/typescript-book-chinese/tips/limitPropertySetters.html" class="sidebar-link">减少 setter 属性的使用</a></li><li><a href="/typescript-book-chinese/tips/createArrays.html" class="sidebar-link">创建数组</a></li><li><a href="/typescript-book-chinese/tips/outFileCaution.html" class="sidebar-link">谨慎使用 --outFile</a></li><li><a href="/typescript-book-chinese/tips/staticConstructors.html" class="sidebar-link">TypeScript 中的静态构造函数</a></li><li><a href="/typescript-book-chinese/tips/singletonPatern.html" class="sidebar-link">单例模式</a></li><li><a href="/typescript-book-chinese/tips/functionParameters.html" class="sidebar-link">函数参数</a></li><li><a href="/typescript-book-chinese/tips/truthy.html" class="sidebar-link">Truthy</a></li><li><a href="/typescript-book-chinese/tips/buildToggles.html" class="sidebar-link">构建切换</a></li><li><a href="/typescript-book-chinese/tips/typesafeEventEmitter.html" class="sidebar-link">类型安全的 Event Emitter</a></li><li><a href="/typescript-book-chinese/tips/metadata.html" class="sidebar-link">Reflect Metadata</a></li><li><a href="/typescript-book-chinese/tips/covarianceAndContravariance.html" class="sidebar-link">协变与逆变</a></li><li><a href="/typescript-book-chinese/tips/infer.html" class="sidebar-link">infer</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>TypeScript 编译原理</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/typescript-book-chinese/compiler/overview.html" class="sidebar-link">概览</a></li><li><a href="/typescript-book-chinese/compiler/program.html" class="sidebar-link">程序</a></li><li><a href="/typescript-book-chinese/compiler/ast.html" class="sidebar-link">抽象语法树</a></li><li><a href="/typescript-book-chinese/compiler/scanner.html" class="sidebar-link">扫描器</a></li><li><a href="/typescript-book-chinese/compiler/parser.html" class="sidebar-link">解析器</a></li><li><a href="/typescript-book-chinese/compiler/binder.html" class="sidebar-link">绑定器</a></li><li><a href="/typescript-book-chinese/compiler/checker.html" class="sidebar-link">检查器</a></li><li><a href="/typescript-book-chinese/compiler/emitter.html" class="sidebar-link">发射器</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>TypeScript FAQs</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/typescript-book-chinese/faqs/common-bug-not-bugs.html" class="sidebar-link">一些常见的「bug」并不是 bug</a></li><li><a href="/typescript-book-chinese/faqs/common-feature-request.html" class="sidebar-link">一些常见的 Feature 需求</a></li><li><a href="/typescript-book-chinese/faqs/type-system-behavior.html" class="sidebar-link">类型系统的行为</a></li><li><a href="/typescript-book-chinese/faqs/function.html" class="sidebar-link">函数</a></li><li><a href="/typescript-book-chinese/faqs/class.html" class="sidebar-link">类</a></li><li><a href="/typescript-book-chinese/faqs/generics.html" class="sidebar-link">泛型</a></li><li><a href="/typescript-book-chinese/faqs/modules.html" class="sidebar-link">模块</a></li><li><a href="/typescript-book-chinese/faqs/enums.html" class="sidebar-link">枚举</a></li><li><a href="/typescript-book-chinese/faqs/type-guards.html" class="sidebar-link">类型守卫</a></li><li><a href="/typescript-book-chinese/faqs/jsx-and-react.html" class="sidebar-link">JSX 和 React</a></li><li><a href="/typescript-book-chinese/faqs/thing-that-dont-work.html" class="sidebar-link">一些不能按预期工作的代码</a></li><li><a href="/typescript-book-chinese/faqs/commandline-behavior.html" class="sidebar-link">命令行的行为</a></li><li><a href="/typescript-book-chinese/faqs/tsconfig-behavior.html" class="sidebar-link">tsconfig.json 的行为</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>TypeScript 更新</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/typescript-book-chinese/new/typescript-3.9.html" class="sidebar-link">TypeScript 3.9</a></li><li><a href="/typescript-book-chinese/new/typescript-3.8.html" class="sidebar-link">TypeScript 3.8</a></li><li><a href="/typescript-book-chinese/new/typescript-3.7.html" class="sidebar-link">TypeScript 3.7</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="ads" data-v-0bfb48e2><div class="item" data-v-0bfb48e2><h6 class="title" style="display:;" data-v-0bfb48e2>关注公众号</h6> <div class="thumb" data-v-0bfb48e2><a href="/typescript-book-chinese/qrcode.jpg" target="_blank" data-v-0bfb48e2><img src="/typescript-book-chinese/qrcode.jpg" alt="关注公众号" data-v-0bfb48e2></a></div></div><div class="item" data-v-0bfb48e2><h6 class="title" style="display:;" data-v-0bfb48e2>与我交流</h6> <div class="thumb" data-v-0bfb48e2><a href="/typescript-book-chinese/contact.png" target="_blank" data-v-0bfb48e2><img src="/typescript-book-chinese/contact.png" alt="与我交流" data-v-0bfb48e2></a></div></div><div class="item" data-v-0bfb48e2><h6 class="title" style="display:;" data-v-0bfb48e2>购买此书</h6> <div class="thumb" data-v-0bfb48e2><a href="https://item.jd.com/12755624.html" target="_blank" data-v-0bfb48e2><img src="https://static.jkchao.cn/2019-11-22/WechatIMG719.png?imageMogr2/auto-orient/thumbnail/80x/blur/1x0/quality/75|imageslim" alt="购买此书" data-v-0bfb48e2></a></div></div></div> <div class="content default"><h1 id="泛型"><a href="#泛型" aria-hidden="true" class="header-anchor">#</a> 泛型</h1> <p>设计泛型的关键目的是在成员之间提供有意义的约束，这些成员可以是：</p> <ul><li>类的实例成员</li> <li>类的方法</li> <li>函数参数</li> <li>函数返回值</li></ul> <h2 id="动机和示例"><a href="#动机和示例" aria-hidden="true" class="header-anchor">#</a> 动机和示例</h2> <p>下面是对一个先进先出的数据结构——队列，在 <code>TypeScript</code> 和 <code>JavaScript</code> 中的简单实现。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">class</span> <span class="token class-name">Queue</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token function-variable function">push</span> <span class="token operator">=</span> item <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function-variable function">pop</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>在上述代码中存在一个问题，它允许你向队列中添加任何类型的数据，当然，当数据被弹出队列时，也可以是任意类型。在下面的示例中，看起来人们可以向队列中添加<code>string</code> 类型的数据，但是实际上，该用法假定的是只有 <code>number</code> 类型会被添加到队列里。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">class</span> <span class="token class-name">Queue</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token function-variable function">push</span> <span class="token operator">=</span> item <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function-variable function">pop</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> queue <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Queue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

queue<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
queue<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Oops，一个错误</span>

<span class="token comment">// 一个使用者，走入了误区</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>queue<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toPrecision</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>queue<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toPrecision</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// RUNTIME ERROR</span>
</code></pre></div><p>一个解决的办法（事实上，这也是不支持泛型类型的唯一解决办法）是为这些约束创建特殊类，如快速创建数字类型的队列：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">class</span> <span class="token class-name">QueueNumber</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token function-variable function">push</span> <span class="token operator">=</span> <span class="token punctuation">(</span>item<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
  pop <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> queue <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">QueueNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

queue<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
queue<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Error: 不能推入一个 `string` 类型，只能是 `number` 类型</span>

<span class="token comment">// 如果该错误得到修复，其他将不会出现问题</span>
</code></pre></div><p>当然，快速也意味着痛苦。例如当你想创建一个字符串的队列时，你将不得不再次修改相当大的代码。我们真正想要的一种方式是无论什么类型被推入队列，被推出的类型都与推入类型一样。当你使用泛型时，这会很容易：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// 创建一个泛型类</span>
<span class="token keyword">class</span> <span class="token class-name">Queue<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> data<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token function-variable function">push</span> <span class="token operator">=</span> <span class="token punctuation">(</span>item<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
  pop <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token operator">|</span> <span class="token keyword">undefined</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 简单的使用</span>
<span class="token keyword">const</span> queue <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Queue<span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token operator">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
queue<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
queue<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Error：不能推入一个 `string`，只有 number 类型被允许</span>
</code></pre></div><p>另外一个我们见过的例子：一个 <code>reverse</code> 函数，现在在这个函数里提供了函数参数与函数返回值的约束：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token generic-function"><span class="token function">reverse</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>items<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> toreturn <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> items<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    toreturn<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>items<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> toreturn<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> sample <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> reversed <span class="token operator">=</span> <span class="token function">reverse</span><span class="token punctuation">(</span>sample<span class="token punctuation">)</span><span class="token punctuation">;</span>

reversed<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'1'</span><span class="token punctuation">;</span> <span class="token comment">// Error</span>
reversed <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token string">'2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// Error</span>

reversed<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// ok</span>
reversed <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// ok</span>
</code></pre></div><p>在此章节中，你已经了解在<em>类</em>和<em>函数</em>上使用泛型的例子。一个值得补充一点的是，你可以为创建的成员函数添加泛型：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">class</span> <span class="token class-name">Utility</span> <span class="token punctuation">{</span>
  <span class="token generic-function"><span class="token function">reverse</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>items<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> toreturn <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> items<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      toreturn<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>items<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> toreturn<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>你可以随意调用泛型参数，当你使用简单的泛型时，泛型常用 <code>T</code>、<code>U</code>、<code>V</code> 表示。如果在你的参数里，不止拥有一个泛型，你应该使用一个更语义化名称，如 <code>TKey</code> 和 <code>TValue</code> （通常情况下，以 <code>T</code> 作为泛型的前缀，在其他语言如 C++ 里，也被称为模板）</p></div> <h2 id="误用的泛型"><a href="#误用的泛型" aria-hidden="true" class="header-anchor">#</a> 误用的泛型</h2> <p>我见过开发者使用泛型仅仅是为了它的 hack。当你使用它时，你应该问问自己：你想用它来提供什么样的约束。如果你不能很好的回答它，你可能会误用泛型，如：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token generic-function"><span class="token function">foo</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>arg<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
</code></pre></div><p>在这里，泛型完全没有必要使用，因为它仅用于单个参数的位置，使用如下方式可能更好：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span>arg<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="设计模式：方便通用"><a href="#设计模式：方便通用" aria-hidden="true" class="header-anchor">#</a> 设计模式：方便通用</h2> <p>考虑如下函数：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token generic-function"><span class="token function">parse</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>
</code></pre></div><p>在这种情况下，泛型 <code>T</code> 只在一个地方被使用了，它并没有在成员之间提供约束 <code>T</code>。这相当于一个如下的类型断言：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">parse</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> something <span class="token operator">=</span> <span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">'something'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> TypeOfSomething<span class="token punctuation">;</span>
</code></pre></div><p>仅使用一次的泛型并不比一个类型断言来的安全。它们都给你使用 API 提供了便利。</p> <p>另一个明显的例子是，一个用于加载 json 返回值函数，它返回你任何传入类型的 <code>Promise</code>：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> getJSON <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>config<span class="token operator">:</span> <span class="token punctuation">{</span> url<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> headers<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token punctuation">[</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> fetchConfig <span class="token operator">=</span> <span class="token punctuation">{</span>
    method<span class="token operator">:</span> <span class="token string">'GET'</span><span class="token punctuation">,</span>
    Accept<span class="token operator">:</span> <span class="token string">'application/json'</span><span class="token punctuation">,</span>
    <span class="token string">'Content-Type'</span><span class="token operator">:</span> <span class="token string">'application/json'</span><span class="token punctuation">,</span>
    <span class="token operator">...</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>headers <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">fetch</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>url<span class="token punctuation">,</span> fetchConfig<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token generic-function"><span class="token function">then</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>response <span class="token operator">=&gt;</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>请注意，你仍然需要明显的注解任何你需要的类型，但是 <code>getJSON&lt;T&gt;</code> 的签名 <code>config =&gt; Promise&lt;T&gt;</code> 能够减少你一些关键的步骤（你不需要注解 <code>loadUsers</code> 的返回类型，因为它能够被推出来）：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">type</span> <span class="token class-name">LoadUserResponse</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  user<span class="token operator">:</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    email<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">loaderUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token generic-function"><span class="token function">getJSON</span><span class="token generic class-name"><span class="token operator">&lt;</span>LoadUserResponse<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">{</span> url<span class="token operator">:</span> <span class="token string">'https://example.com/users'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>与此类似：使用 <code>Promise&lt;T&gt;</code> 作为一个函数的返回值比一些如：<code>Promise&lt;any&gt;</code> 的备选方案要好很多。</p> <h3 id="配合-axios-使用"><a href="#配合-axios-使用" aria-hidden="true" class="header-anchor">#</a> 配合 axios 使用</h3> <p>通常情况下，我们会把后端返回数据格式单独放入一个 interface 里：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// 请求接口数据</span>
<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">ResponseData<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token operator">=</span> <span class="token builtin">any</span><span class="token operator">&gt;</span></span> <span class="token punctuation">{</span>
  <span class="token comment">/**
   * 状态码
   * @type { number }
   */</span>
  code<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>

  <span class="token comment">/**
   * 数据
   * @type { T }
   */</span>
  result<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>

  <span class="token comment">/**
   * 消息
   * @type { string }
   */</span>
  message<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>当我们把 API 单独抽离成单个模块时：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// 在 axios.ts 文件中对 axios 进行了处理，例如添加通用配置、拦截器等</span>
<span class="token keyword">import</span> Ax <span class="token keyword">from</span> <span class="token string">'./axios'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> ResponseData <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./interface.ts'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token generic-function"><span class="token function">getUser</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> Ax<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">get</span><span class="token generic class-name"><span class="token operator">&lt;</span>ResponseData<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">'/somepath'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>res <span class="token operator">=&gt;</span> res<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span>err <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>接着我们写入返回的数据类型 <code>User</code>，这可以让 TypeScript 顺利推断出我们想要的类型：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">interface</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  age<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// user 被推断出为</span>
  <span class="token comment">// {</span>
  <span class="token comment">//  code: number,</span>
  <span class="token comment">//  result: { name: string, age: number },</span>
  <span class="token comment">//  message: string</span>
  <span class="token comment">// }</span>
  <span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token generic-function"><span class="token function">getUser</span><span class="token generic class-name"><span class="token operator">&lt;</span>User<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/jkchao/typescript-book-chinese/edit/master/docs/typings/generices.md" target="_blank" rel="noopener noreferrer">编辑此页</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">上次更新: </span> <span class="time">11/2/2021, 5:59:50 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/typescript-book-chinese/typings/readonly.html" class="prev">
          readonly
        </a></span> <span class="next"><a href="/typescript-book-chinese/typings/typeInference.html">
          类型推断
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/typescript-book-chinese/assets/js/app.9fb1acd5.js" defer></script><script src="/typescript-book-chinese/assets/js/3.5dc3b6f0.js" defer></script><script src="/typescript-book-chinese/assets/js/2.2356e89f.js" defer></script><script src="/typescript-book-chinese/assets/js/73.3b873418.js" defer></script>
  </body>
</html>
